<div class="admin-categories">
  <div class="page-header">
    <div>
      <h2>{{ lang.t('admin.categories') }}</h2>
      <p>{{ lang.t('admin.manageCategories') }}</p>
    </div>
    <button (click)="openModal()" class="btn-add">
      <i class="fas fa-plus"></i>
      {{ lang.t('admin.addNew') }}
    </button>
  </div>

  <div class="filters-bar">
    <div class="search-box">
      <i class="fas fa-search"></i>
      <input 
        type="text" 
        [(ngModel)]="q" 
        [placeholder]="lang.t('admin.searchCategories')"
        (keyup.enter)="load()"
      />
    </div>
    <button (click)="load()" class="filter-btn">
      <i class="fas fa-filter"></i>
      {{ lang.t('admin.filter') }}
    </button>
  </div>

  <div *ngIf="loading()" class="loading">
    <i class="fas fa-spinner fa-spin"></i>
    {{ lang.t('admin.loading') }}
  </div>

  <div *ngIf="!loading() && categories().length === 0" class="no-data">
    <i class="fas fa-th-large"></i>
    <p>{{ lang.t('admin.noData') }}</p>
  </div>

  <div *ngIf="!loading() && categories().length > 0" class="table-container">
    <table class="admin-table">
      <thead>
        <tr>
          <th>{{ lang.t('admin.categoryName') }}</th>
          <th>{{ lang.t('admin.slug') }}</th>
          <th>{{ lang.t('admin.description') }}</th>
          <th>{{ lang.t('admin.status') }}</th>
          <th>{{ lang.t('admin.sortOrder') }}</th>
          <th>{{ lang.t('admin.actions') }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let c of categories()" [@fadeIn]>
          <td>
            <div class="category-name">
              <i class="fas fa-folder"></i>
              {{ c.name }}
            </div>
          </td>
          <td>
            <span class="slug">{{ c.slug }}</span>
          </td>
          <td>
            <span class="description">{{ c.description || '-' }}</span>
          </td>
          <td>
            <span class="status-badge" [class.active]="c.isActive" [class.inactive]="!c.isActive">
              {{ c.isActive ? lang.t('admin.active') : lang.t('admin.inactive') }}
            </span>
          </td>
          <td>
            <span class="sort-order">{{ c.sortOrder || 0 }}</span>
          </td>
          <td>
            <div class="action-buttons">
              <button (click)="openModal(c)" class="btn-edit">
                <i class="fas fa-edit"></i>
                {{ lang.t('admin.edit') }}
              </button>
              <button (click)="deleteCategory(c)" class="btn-delete">
                <i class="fas fa-trash"></i>
                {{ lang.t('admin.delete') }}
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Modal -->
  <div class="modal-overlay" *ngIf="showModal" (click)="closeModal()" [@fadeIn]>
    <div class="modal-content" (click)="$event.stopPropagation()" [@slideIn]>
      <div class="modal-header">
        <h3>
          <i class="fas fa-folder-plus"></i>
          {{ editing ? lang.t('admin.edit') + ' ' + lang.t('admin.category') : lang.t('admin.addNew') + ' ' + lang.t('admin.category') }}
        </h3>
        <button class="close-btn" (click)="closeModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="modal-body">
        <div class="form-group">
          <label>{{ lang.t('admin.categoryName') }} <span class="required">*</span></label>
          <input 
            type="text" 
            [(ngModel)]="form.name" 
            [placeholder]="lang.t('admin.categoryName')"
            (input)="generateSlug()"
          />
        </div>

        <div class="form-group">
          <label>{{ lang.t('admin.slug') }} <span class="required">*</span></label>
          <input 
            type="text" 
            [(ngModel)]="form.slug" 
            [placeholder]="lang.t('admin.slug')"
          />
        </div>

        <div class="form-group">
          <label>{{ lang.t('admin.description') }}</label>
          <textarea 
            [(ngModel)]="form.description" 
            [placeholder]="lang.t('admin.description')"
            rows="3"
          ></textarea>
        </div>

        <div class="form-group">
          <label>{{ lang.t('admin.sortOrder') }}</label>
          <input 
            type="number" 
            [(ngModel)]="form.sortOrder" 
            [placeholder]="lang.t('admin.sortOrder')"
            min="0"
          />
        </div>

        <div class="form-group checkbox-group">
          <label class="checkbox-label">
            <input type="checkbox" [(ngModel)]="form.isActive" />
            <span class="checkbox-text">{{ lang.t('admin.active') }}</span>
          </label>
        </div>
      </div>

      <div class="modal-footer">
        <button (click)="closeModal()" class="btn-cancel">
          <i class="fas fa-times"></i>
          {{ lang.t('admin.cancel') }}
        </button>
        <button (click)="save()" class="btn-save">
          <i class="fas fa-save"></i>
          {{ lang.t('admin.save') }}
        </button>
      </div>
    </div>
  </div>
</div>
